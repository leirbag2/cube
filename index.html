<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Cubo NxN</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div id="app">
      <header class="topbar">
        <div class="brand">Cubo NxN</div>
        <div class="controls center-controls" id="scrambleControls">
          <button id="prevScramble" class="secondary">◀</button>
          <div id="scrambleText" class="scramble scramble-top"></div>
          <button id="nextScramble" class="secondary">▶</button>
          <button id="applyScramble">Aplicar</button>
          <button id="clearScramble">Limpiar</button>
        </div>
        <div class="controls right-controls">
          <label class="control">
            Tamaño
            <input id="size" type="range" min="2" max="11" value="3" />
            <span id="sizeValue">3</span>
          </label>
          <button id="rebuild">Recrear</button>
          <button id="resetView">Centrar vista</button>
          <button id="openSettings" class="secondary">Configuración</button>
          <button id="openHelp" class="secondary">Ayuda</button>
        </div>
      </header>

      <main class="main">
        <section class="scene">
          <div id="renderer"></div>
          <div class="hud">
            <div class="timer" id="timer">0.000</div>
            <div class="timer-hint">Espacio para iniciar/detener</div>
          </div>
          <div id="netView" class="net-view net-overlay hidden"></div>
        </section>

        <aside class="panel">
          <section class="card sessions-card">
            <h2>Movimientos</h2>
            <div class="row">
              <label class="control">
                Capa activa
                <input id="layer" type="range" min="1" max="3" value="1" />
                <span id="layerValue">1</span>
              </label>
            </div>
            <div class="move-grid" id="moveButtons"></div>
            <div class="hint">
              Teclado: I/K (R/R'), U/M (r/r'), J (U), F (U'), L/S (D'/D), V (L), R/E (L'), D (L), H/G (F/F'), W (B), O (B'), X (M). Rotaciones: Ñ (Y), A (Y'), Y/T (X), B/N (X'), Q (Z), P (Z').
            </div>
          </section>


          <section class="card">
            <h2>Sesiones</h2>
            <div class="row session-row">
              <input id="sessionName" placeholder="Nombre" />
              <button id="createSession">Crear</button>
            </div>
            <div class="row session-row">
              <select id="sessionSelect"></select>
              <button id="deleteSession">Borrar</button>
            </div>
            <div class="stats-grid">
              <div>Mejor: <span id="best">-</span></div>
              <div>Promedio: <span id="avg">-</span></div>
              <div>Ao5: <span id="ao5">-</span></div>
              <div>Ao12: <span id="ao12">-</span></div>
              <div>Solves: <span id="count">0</span></div>
            </div>
            <div id="times" class="times"></div>
          </section>

        </aside>
      </main>
    </div>

    <div id="settingsModal" class="modal hidden" aria-hidden="true">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Configuración</h2>
          <button id="closeSettings" class="secondary">Cerrar</button>
        </div>
        <section class="modal-section">
          <h3>Vista</h3>
          <div class="row">
            <button id="toggleXray">X-ray</button>
            <button id="toggleExplode">Exploded</button>
            <button id="toggleNet">Net</button>
          </div>
        </section>
        <section class="modal-section">
          <h3>Colores</h3>
          <div class="row">
            <label class="control">
              Paleta
              <select id="paletteSelect"></select>
            </label>
            <button id="resetPalette">Reset</button>
          </div>
          <div class="color-grid" id="colorGrid"></div>
        </section>
        <section class="modal-section">
          <h3>Bordes</h3>
          <div class="row">
            <label class="control">
              Grosor
              <input id="edgeThickness" type="range" min="0" max="100" value="70" />
              <span id="edgeValue">70</span>
            </label>
          </div>
        </section>
      </div>
    </div>

    <div id="helpModal" class="modal hidden" aria-hidden="true">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Ayuda</h2>
          <button id="closeHelp" class="secondary">Cerrar</button>
        </div>
        <section class="modal-section">
          <h3>Mouse</h3>
          <div class="hint">Arrastra para rotar la vista. Rueda para zoom.</div>
        </section>
        <section class="modal-section">
          <h3>Timer</h3>
          <div class="hint">Espacio inicia/detiene. Enter registra tiempo manual.</div>
          <div class="hint">Al aplicar scramble, el primer movimiento inicia el timer y al resolver se guarda.</div>
        </section>
        <section class="modal-section">
          <h3>Teclado</h3>
          <div class="hint">
            I/K (R/R'), U/M (r/r'), J (U), F (U'), L/S (D'/D), V (L), R/E (L'), D (L), H/G (F/F'), W (B), O (B'), X (M).
          </div>
          <div class="hint">
            Rotaciones: Ñ (Y), A (Y'), Y/T (X), B/N (X'), Q (Z), P (Z').
          </div>
          <div class="hint">
            Capa activa: números 1-9 o `-`/`=` para ajustar.
          </div>
        </section>
      </div>
    </div>

    <script type="importmap">
      {
        "imports": {
          "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
          "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
        }
      }
    </script>
    <script type="module" src="app.js"></script>
  </body>
</html>
